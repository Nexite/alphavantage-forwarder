generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Symbol {
  id              String            @id // e.g., "AAPL"
  dailyQuotes     DailyQuote[]
  dailyOptions    DailyOptionsChain[]
  dailyContracts  DailyOptionContract[]
}

model DailyQuote {
  id          String      @id // format: "{symbolId}-{date}"
  symbol      Symbol      @relation(fields: [symbolId], references: [id])
  symbolId    String
  price       Decimal
  date        DateTime
  
  @@unique([symbolId, date])
  @@index([date])
  @@index([symbolId, date])
}

model DailyOptionsChain {
  id              String                 @id // format: "{symbolId}-{date}"
  symbol          Symbol                 @relation(fields: [symbolId], references: [id])
  symbolId        String
  date            DateTime
  contracts       DailyOptionContract[]

  @@unique([symbolId, date])
  @@index([date])
}

model DailyOptionContract {
  id                 String             @id // The contractID from your example
  symbol            Symbol             @relation(fields: [symbolId], references: [id])
  symbolId          String
  chain             DailyOptionsChain  @relation(fields: [chainId], references: [id])
  chainId           String
  expiration        DateTime
  strike            Decimal
  type              OptionType
  last              Decimal?
  mark              Decimal?
  bid               Decimal?
  bidSize           Int?
  ask               Decimal?
  askSize           Int?
  volume            Int?
  openInterest      Int?
  impliedVolatility Decimal?
  delta             Decimal?
  gamma             Decimal?
  theta             Decimal?
  vega              Decimal?
  rho               Decimal?

  @@index([symbolId, expiration])
  @@index([chainId])
}

enum OptionType {
  CALL
  PUT
}


model Holiday {
  id          String      @id // format: "{yyyy}-{MM}-{dd}"
  date        DateTime
  type        HolidayType
}

enum HolidayType {
  CLOSED
  EARLY_CLOSE
}